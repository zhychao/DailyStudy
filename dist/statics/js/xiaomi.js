function showquery(tid){function Methods(a,t,e,n){HuiJuCommon.prototype.showloading(),$.ajax({url:t,type:"get",data:e,success:function(a){HuiJuCommon.prototype.hideloading(),n(a)},error:function(a,t){HuiJuCommon.prototype.hideloading(),HuiJuCommon.prototype.errBackFn(a,t)}})}function showDate(){var a=(new Date).getFullYear(),t={};t.date={preset:"date"},t.datetime={preset:"datetime"},t.time={preset:"time"},t.default={theme:"android-ics light",display:"modal",mode:"scroller",dateFormat:"yyyy-mm-dd",lang:"zh",onSelect:mobiscroll_select,dateOrder:"yymm",headerText:function(a){return"请选择年月"},startYear:a-3,endYear:a+3},$(".dateClick").mobiscroll($.extend(t.date,t.default))}function mobiscroll_select(a,t){$(".showmonth").val(a),getDate(a),showDate()}function getDate(day){var d=new Date(day),Days=new Date(d.getFullYear(),d.getMonth()+1,0).getDate(),month=d.getMonth()+1;month>=1&&month<=9&&(month="0"+month),beginTime=d.getFullYear()+""+month+"01000000",endTime=d.getFullYear()+""+month+Days+"235959";var html="",html='<p class="time"><input type="text" id="showmonth" class="showmonth" value="'+d.getFullYear()+"/"+month+'" style="border: none;background:none" readonly /><input type="text" class="dateClick"></p>';Methods("post",urls,"pageNum=1&numPerPage=20&beginDate="+beginTime+"&endDate="+endTime,function(data){var resultObj=eval("("+data+")");$("#hinput").val(1),$("#total").val(resultObj.totalCount),""==resultObj.transList?$("."+tid).html(html+"<span class='NoDtaList'><img src='http://cdn.yqifu.com/img_no_data.png'><p>暂无数据</p></span>"):($.each(resultObj.transList,function(a,t){var e="http://cdn.yqifu.com/img_bank_wechat.png";"tradingquery_ps"==tid&&(e="http://cdn.yqifu.com/"+t.bankIcon),"ALIPAY"==t.bankNo&&(e="http://cdn.yqifu.com/img_bank_alipay.png"),"tradingquery_wk"==tid&&(e="http://cdn.yqifu.com/Union-ico-img.png"),"交易失败"==t.status?html+='<li><span class="bankImg"><img src="'+e+'"></span><p><span class="title">'+t.bankName+'</span><span class="money">￥'+t.amount+'</span></p><p><span class="dateTime">'+t.transTime+'</span><span class="status red">'+t.status+'</span></p><a href="'+detail_url+"?id="+t.trxNo+'"></a></li>':html+='<li><span class="bankImg"><img src="'+e+'"></span><p><span class="title">'+t.bankName+'</span><span class="money">￥'+t.amount+'</span></p><p><span class="dateTime">'+t.transTime+'</span><span class="status">'+t.status+'</span></p><a href="'+detail_url+"?id="+t.trxNo+'"></a></li>'}),$("."+tid).html(html)),showDate()})}$("#hinput").val(1);var detail_url="";"tradingquery_wx"==tid?(urls="queryWeChatTrade",detail_url=baseUrl+"/wx/trade/queryWeChatTradeDetail"):"tradingquery_ps"==tid?(urls="queryPosTrade",detail_url="queryPosTradeDetail"):(urls="queryNoCardTrans",detail_url="queryNoCardTradeDetail");var d=new Date;getDate(d);var itemsPerLoad=20;$(window).scroll(function(){var hval=parseInt($("#hinput").val())+1,pages=$("#total").val(),page=Math.ceil(pages/20);if(!(hval>page)){$("#hinput").val(hval);var html="";Methods("post",urls,"pageNum="+hval+"&numPerPage=20&beginDate="+beginTime+"&endDate="+endTime,function(data){var ds=eval("("+data+")");$.each(ds.transList,function(a,t){var e="http://cdn.yqifu.com/img_bank_wechat.png";"tradingquery_ps"==tid&&(e="http://cdn.yqifu.com/"+t.bankIcon),"tradingquery_wk"==tid&&(e="http://cdn.yqifu.com/"+t.bankIcon),"ALIPAY"==t.bankNo&&(e="http://cdn.yqifu.com/img_bank_alipay.png"),"交易失败"==t.status?html+='<li><span class="bankImg"><img src="'+e+'"></span><p><span class="title">'+t.bankName+'</span><span class="money">￥'+t.amount+'</span></p><p><span class="dateTime">'+t.transTime+'</span><span class="status red">'+t.status+'</span></p><a href="'+detail_url+"?id="+t.trxNo+'"></a></li>':html+='<li><span class="bankImg"><img src="'+e+'"></span><p><span class="title">'+t.bankName+'</span><span class="money">￥'+t.amount+'</span></p><p><span class="dateTime">'+t.transTime+'</span><span class="status">'+t.status+'</span></p><a href="'+detail_url+"?id="+t.trxNo+'"></a></li>'}),$("."+tid).append(html)})}})}var beginTime="",endTime="",urls="";showquery("tradingquery_wx");